<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pricing Calculator</title>
    <!-- Načítanie Tailwind CSS pre rýchly a moderný styling (Dark Mode) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Nastavenie písma Inter a tmavého pozadia */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* GitHub Dark Mode background */
        }
        
        /* Vlastné štýly pre posuvníky, aby vyzerali ako moderné guľôčky */
        input[type='range'] {
            -webkit-appearance: none;
            appearance: none;
            height: 8px;
            background: #374151; /* Tmavý track */
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }

        input[type='range']::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px; /* Zmenšené */
            height: 18px; /* Zmenšené */
            border-radius: 50%;
            background: #3B82F6; /* Default Blue Thumb */
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
            transition: all 0.2s;
        }
        
        input[type='range']::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }

        /* Špecifické farby pre Allegro a Kaufland */
        #allegro::-webkit-slider-thumb {
            background: #FF6600; /* Allegro Orange */
        }
        #kaufland::-webkit-slider-thumb {
            background: #DC2626; /* Kaufland Red */
        }

        /* Firefox Thumb styles */
        input[type='range']::-moz-range-thumb {
            width: 18px; /* Zmenené */
            height: 18px; /* Zmenené */
            border-radius: 50%;
            background: #3B82F6;
            border: none;
        }
        #allegro::-moz-range-thumb { background: #FF6600; }
        #kaufland::-moz-range-thumb { background: #DC2626; }
        
        /* Štýl pre logo */
        #logo-container {
            height: 32px; /* Zmenšené */
        }
    </style>
</head>
<body class="p-8 text-white min-h-screen">

    <!-- Kontajner zmenený na max-w-6xl pre širší vzhľad A PRIDANÝ SPODNÝ MARGIN (pb-[20vh]) -->
    <div class="max-w-6xl mx-auto pb-[20vh]">
        <!-- Hlavička s Logom a Názvom -->
        <header class="flex items-center justify-between pb-4 border-b border-gray-700 mb-8">
            <div id="logo-container">
                <img src="https://app.merchantee.io/images/merchantee_darkmode_logo.png" alt="Merchantee Logo" class="h-full">
            </div>
            <!-- Zmenšené písmo a zjemnené bold -->
            <h1 class="text-2xl font-semibold text-white-200">Pricing Calculator</h1>
        </header>

        <!-- Hlavný kontajner pre metriky a výsledky: Používame grid s flexboxom pre zarovnanie -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <!-- Stĺpec 1: Dynamický Pricing (Produkty) - flex flex-col pre zarovnanie spodného boxu -->
            <div class="bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700 col-span-1 flex flex-col">
                
                <!-- Obsah, ktorý má zostať hore -->
                <div>
                    <!-- Zmenšené písmo -->
                    <h3 class="text-lg font-normal mb-4 text-white-100">Počet produktov na Marketplace</h3>
                    
                    <div class="slider-group mb-4">
                        <label for="products" class="block text-sm font-normal mb-1 text-gray-300">(zalistovaných produktov.)</label>
                        <!-- ZMENA: Min/Max/Step na nelineárne mapovanie -->
                        <input type="range" id="products" min="0" max="1000" step="1" value="0">
                        <div class="text-base mt-1 flex justify-between"> <!-- Zmenšené písmo -->
                            <span id="products-value" class="font-normal text-gray-300">500</span> ks
                            <span id="products-tier" class="text-xs text-gray-400 bg-gray-700 py-0.5 px-2 rounded">Tier: 500 - 2,000</span>
                        </div>
                    </div>
                </div>

                <!-- FLEXIBLE ROZDELOVAČ: Natlačí súhrnný box na spodok stĺpca -->
                <div class="flex-grow"></div> 

                <!-- DPUC Result Box (Zarovna sa na spodok) -->
                <div class="mt-4 p-3 bg-gray-700 rounded-lg text-center">
                    <p class="text-sm text-gray-400">Cena DP na 1 Krajinu a 1 Trh:</p>
                    <span id="dpuc-cost" class="text-xl font-semibold text-green-400">49,00 €</span> <!-- Zmenšené písmo -->
                </div>
            </div>

            <!-- Stĺpec 2: Dynamic Pricing Markets (Allegro a Kaufland) - PONECHANÝ pôvodný štýl ako referencia -->
            <div class="bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700 col-span-1 flex flex-col">
                <!-- Zmenšené písmo -->
                <h3 class="text-lg font-normal mb-4 text-white-200">Na koľkých trhoch chceme DP?</h3>
                
                <!-- Allegro Slider -->
                <div class="slider-group mb-6 p-3 border border-orange-500/50 rounded-lg bg-gray-700/30">
                    <div class="flex items-center justify-between mb-2">
                        <label for="allegro" class="text-sm font-normal flex items-center text-gray-300">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1 text-orange-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm-7-8a7 7 0 1114 0 7 7 0 01-14 0zM8.28 7.37a.75.75 0 00-1.06 1.06L9.94 11l-2.72 2.72a.75.75 0 101.06 1.06L11 12.06l2.72 2.72a.75.75 0 101.06-1.06L12.06 11l2.72-2.72a.75.75 0 10-1.06-1.06L11 9.94l-2.72-2.72z" clip-rule="evenodd" fill="#FF6600"/></svg>
                            Allegro
                        </label>
                        <!-- Zmenšené písmo -->
                        <span id="allegro-value" class="text-base font-normal text-orange-400">0</span>
                    </div>
                    <!-- min="0" -->
                    <input type="range" id="allegro" min="0" max="4" step="1" value="0">
                </div>

                <!-- Kaufland Slider -->
                <div class="slider-group mb-6 p-3 border border-red-500/50 rounded-lg bg-gray-700/30">
                    <div class="flex items-center justify-between mb-2">
                        <label for="kaufland" class="text-sm font-normal flex items-center text-gray-300">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1 text-red-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.5 7.5a.5.5 0 00-1 0v4.5a.5.5 0 001 0V7.5zm3.5 0a.5.5 0 00-1 0v4.5a.5.5 0 001 0V7.5z" clip-rule="evenodd" fill="#DC2626"/></svg>
                            Kaufland
                        </label>
                        <!-- Zmenšené písmo -->
                        <span id="kaufland-value" class="text-base font-normal text-red-400">0</span>
                    </div>
                    <!-- min="0" -->
                    <input type="range" id="kaufland" min="0" max="9" step="1" value="0">
                </div>
                
                <!-- Celkový počet trhov s DP: ostáva na svojom mieste -->
                <div class="mt-auto p-3 bg-gray-700 rounded-lg text-center">
                    <p class="text-sm text-gray-400">Celkový počet trhov s DP:</p>
                    <!-- Zmenšené písmo -->
                    <span id="markets-total" class="text-xl font-bold text-white-200">0</span> ks
                </div>
            </div>

            <!-- Stĺpec 3: Základná cena systému (Objednávky) & Výsledok - flex flex-col pre zarovnanie spodného boxu -->
            <div class="bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700 col-span-1 flex flex-col">
                
                <!-- Obsah, ktorý má zostať hore -->
                <div>
                    <!-- Zmenšené písmo -->
                    <h3 class="text-lg font-normal mb-4 text-white-200">Koľko máme mesačne objednávok?</h3>
                    
                    <div class="slider-group mb-4">
                        <label for="orders" class="block text-sm font-normal mb-1 text-gray-300">Celkový počet objednávok</label>
                        <!-- ZMENA: Min/Max/Step na nelineárne mapovanie -->
                        <input type="range" id="orders" min="0" max="1000" step="1" value="0">
                        <div class="text-base mt-1 flex justify-between"> <!-- Zmenšené písmo -->
                            <span id="orders-value" class="font-normal text-gray-300">0</span> ks
                            <span id="orders-tier" class="text-xs text-gray-400 bg-gray-700 py-0.5 px-2 rounded">Tier: 0 - 100</span>
                        </div>
                    </div>
                </div>
                
                <!-- FLEXIBLE ROZDELOVAČ: Natlačí súhrnný box na spodok stĺpca -->
                <div class="flex-grow"></div>

                <!-- BSP Result Box (Zarovna sa na spodok) -->
                <div class="mt-4 p-3 bg-gray-700 rounded-lg text-center">
                    <p class="text-sm text-gray-400">Základná cena systému:</p>
                    <!-- Zmenšené písmo -->
                    <span id="bsp-cost" class="text-xl font-semibold text-green-400">149,00 €</span>
                </div>
            </div>
        </div>

        <!-- Sekcia Súhrn Ceny -->
        <div class="mt-10 p-8 bg-gray-900 border-2 border-green-500 rounded-xl shadow-2xl">
            <!-- Zmenšené písmo -->
            <h3 class="text-xl font-semibold mb-4 text-green-400">Celkové náklady (bez DPH)</h3>
            <div id="pricing-summary" class="space-y-4">
                
                <!-- Cena po prvom mesiaci -->
                <div class="bg-gray-800 p-4 rounded-lg flex justify-between items-center border-l-4 border-blue-400">
                    <div>
                        <p class="font-normal text-lg">Mesačné náklady (Po 1. Mesiaci):</p> <!-- Zjemnené bold -->
                        <p class="text-sm text-gray-400">Základná Cena Systému + Dynamický Pricing</p>
                    </div>
                    <!-- Zmenšené písmo -->
                    <span id="total-price" class="text-3xl font-semibold text-white">0,00 €</span>
                </div>
                
                <!-- Cena za prvý mesiac (AKCIA) -->
                <div class="bg-gray-800 p-4 rounded-lg flex justify-between items-center border-l-4 border-yellow-400">
                    <div>
                        <p class="font-normal text-lg text-yellow-400">Mesačné náklady (Prvý Mesiac DP Neplatíte):</p> <!-- Zjemnené bold -->
                        <p class="text-sm text-gray-400">Dynamický Pricing ZDARMA na všetkých 13 trhoch!</p>
                    </div>
                    <!-- Zmenšené písmo -->
                    <span id="first-month-price" class="text-3xl font-semibold text-yellow-400">0,00 €</span>
                </div>

                <!-- Detaily výpočtu -->
                <div class="pt-4 border-t border-gray-700">
                    <!-- Zmenšené písmo -->
                    <h4 class="text-lg font-normal mb-2 text-white-200">Ako sme to vypočítali?</h4>
                    <ul class="space-y-1 text-sm text-gray-300">
                        <li class="flex justify-between">
                            <span>Základná Cena Systému:</span>
                            <span id="detail-bsp" class="font-normal">0,00 €</span>
                        </li>
                        <li class="flex justify-between">
                            <span>Dynamický Pricing (Cena DP x Počet Trhov):</span>
                            <span id="detail-dynamic-pricing" class="font-normal">0,00 €</span>
                        </li>
                        <!-- Pôvodný riadok "Mesačné náklady Spolu" (detail-total) bol odstránený podľa požiadavky. -->
                    </ul>
                </div>

                    <!-- Zadarmo hodnota -->
                <div class="mt-4 pt-4 border-t border-gray-700">
                    <!-- Zmenšené písmo -->
                    <p class="text-sm text-gray-400 mb-2">Dynamický Pricing na 13 marketoch (limit 2000 produktov) máte v prvom mesiaci zadarmo, hodnota sa mení podľa Vášho zvoleného produktu tieru.</p>
                    <li class="flex justify-between font-normal text-yellow-400 list-none">
                        <span>V Prvom Mesiaci od Nás Dostanete Úplne Zadarmo (Cena DP x 13 Trhov):</span>
                        <span id="detail-value-free" class="font-semibold">0,00 €</span>
                    </li>
                </div>

            </div>
        </div>

    </div>

    <script>
        // Nastavenie pre formátovanie meny s 2 desatinnými miestami a čiarkou
        const formatPrice = (price) => {
            if (typeof price === 'number') {
                return price.toFixed(2).replace('.', ',').toLocaleString('sk-SK') + ' €';
            }
            return price; // Pre "Individuálne"
        };
        
        /**
         * FUNKCIA PRE NON-LINEÁRNE MAPOVANIE POSUVNÍKA
         * Využíva kubickú krivku (mocnina 3), aby bol pohyb na začiatku jemný
         * a rýchlo akceleroval ku koncu rozsahu.
         * @param {number} linearValue - Surová hodnota posuvníka (0 až 1000).
         * @param {number} maxOutput - Maximálna cieľová hodnota.
         * @returns {number} Prepočítaná nelineárna hodnota.
         */
        function getNonLinearValue(linearValue, maxOutput) {
            const power = 3; 
            const normalized = linearValue / 1000; // 0 až 1
            const scaled = Math.pow(normalized, power); // Aplikácia kubickej krivky
            return Math.round(scaled * maxOutput);
        }

        // --- LOGIKA CENOVÝCH TIERov ---
        
        /**
         * Určuje cenu Dynamic Pricing Unit Cost (DPUC) na základe počtu produktov.
         */
        function getDynamicPricingUnitCost(products) {
            if (products <= 2000) return { cost: 49, tier: "500 - 2,000" };
            if (products <= 5000) return { cost: 99, tier: "2,001 - 5,000" };
            if (products <= 10000) return { cost: 149, tier: "5,001 - 10,000" };
            if (products <= 20000) return { cost: 199, tier: "10,001 - 20,000" };
            return { cost: 249, tier: "20,001 - 30,000" };
        }

        /**
         * Určuje Základnú Cenu Systému (BSP) na základe počtu objednávok.
         */
        function getBaseSystemPrice(orders) {
            if (orders <= 100) return { cost: 149, tier: "0 - 100" };
            if (orders <= 5000) return { cost: 249, tier: "101 - 5,000" };
            return { cost: 'Individuálne', tier: "> 5,000" };
        }

        // --- ZÍSKANIE ELEMENTOV ---
        const productsSlider = document.getElementById('products');
        const allegroSlider = document.getElementById('allegro');
        const kauflandSlider = document.getElementById('kaufland');
        const ordersSlider = document.getElementById('orders');

        // Nastavenie počiatočných hodnôt sliderov
        productsSlider.value = 0; // Začíname na 0 (ktoré sa prepočíta na 500)
        allegroSlider.value = 0;
        kauflandSlider.value = 0;
        ordersSlider.value = 0; // Začíname na 0


        const elements = {
            productsValue: document.getElementById('products-value'),
            productsTier: document.getElementById('products-tier'),
            dpucCost: document.getElementById('dpuc-cost'),
            allegroValue: document.getElementById('allegro-value'),
            kauflandValue: document.getElementById('kaufland-value'),
            marketsTotal: document.getElementById('markets-total'),
            ordersValue: document.getElementById('orders-value'),
            ordersTier: document.getElementById('orders-tier'),
            bspCost: document.getElementById('bsp-cost'),
            totalPrice: document.getElementById('total-price'),
            firstMonthPrice: document.getElementById('first-month-price'),
            detailBsp: document.getElementById('detail-bsp'),
            detailDynamicPricing: document.getElementById('detail-dynamic-pricing'),
            // detailTotal bol odstránený
            detailValueFree: document.getElementById('detail-value-free'),
        };

        // --- HLAVNÁ KALKULAČNÁ FUNKCIA ---
        function updatePricing() {
            // Získanie a Nelineárne Prepočítanie Hodnôt
            
            // Produkty (Rozsah 500 až 30,000)
            const maxProductsRange = 30000;
            const minProducts = 500;
            const productsNormalized = parseInt(productsSlider.value); // 0-1000
            
            // Aplikácia krivky, posun o minProducts, zaokrúhlenie na 100 (aby sa vyhlo nepresným číslam)
            let products = minProducts + getNonLinearValue(productsNormalized, maxProductsRange - minProducts);
            products = Math.max(minProducts, Math.round(products / 100) * 100); // Min. 500 a krok po 100

            // Objednávky (Rozsah 0 až 5,000)
            const maxOrders = 5000;
            const ordersNormalized = parseInt(ordersSlider.value); // 0-1000
            
            // Aplikácia krivky, zaokrúhlenie na 10 (pre jemnú kontrolu na začiatku)
            let orders = getNonLinearValue(ordersNormalized, maxOrders);
            orders = Math.round(orders / 10) * 10; // Krok po 10 (jemný krok)

            // Allegro a Kaufland sú lineárne
            const allegro = parseInt(allegroSlider.value);
            const kaufland = parseInt(kauflandSlider.value);

            // 1. DPUC (Dynamic Pricing Unit Cost) podľa produktov
            const dpucResult = getDynamicPricingUnitCost(products);
            const dpuc = dpucResult.cost;
            const dpucTier = dpucResult.tier;
            
            // 2. Total Markets (TM) - Allegro + Kaufland
            const totalMarkets = allegro + kaufland;

            // 3. BSP (Base System Price) podľa objednávok
            const bspResult = getBaseSystemPrice(orders);
            const bsp = bspResult.cost;
            const bspTier = bspResult.tier;

            // --- VÝPOČTY CIEN ---
            
            const dynamicPricingCost = totalMarkets * dpuc; // TM * DPUC

            let totalPriceAfterFirstMonth;
            if (bsp === 'Individuálne') {
                totalPriceAfterFirstMonth = dynamicPricingCost;
            } else {
                totalPriceAfterFirstMonth = dynamicPricingCost + bsp;
            }

            const firstMonthPrice = bsp; 
            const valueFree = 13 * dpuc;

            // --- AKTUALIZÁCIA UI ---

            // Produkty
            elements.productsValue.textContent = products.toLocaleString('sk-SK');
            elements.productsTier.textContent = `Tier: ${dpucTier}`;
            elements.dpucCost.textContent = formatPrice(dpuc);

            // Markety
            elements.allegroValue.textContent = allegro;
            elements.kauflandValue.textContent = kaufland;
            elements.marketsTotal.textContent = totalMarkets;

            // Objednávky
            elements.ordersValue.textContent = orders.toLocaleString('sk-SK');
            elements.ordersTier.textContent = `Tier: ${bspTier}`;
            elements.bspCost.textContent = formatPrice(bsp);

            // Súhrn
            elements.totalPrice.textContent = formatPrice(totalPriceAfterFirstMonth);
            elements.firstMonthPrice.textContent = formatPrice(firstMonthPrice);

            // Detaily
            elements.detailBsp.textContent = formatPrice(bsp);
            
            if (bsp === 'Individuálne') {
                elements.detailBsp.classList.add('text-red-400');
            } else {
                elements.detailBsp.classList.remove('text-red-400');
            }
            
            elements.detailDynamicPricing.textContent = `${totalMarkets}x ${formatPrice(dpuc)} = ${formatPrice(dynamicPricingCost)}`;
            // elements.detailTotal bol odstránený
            elements.detailValueFree.textContent = formatPrice(valueFree);
        }

        // Pripojenie poslucháčov udalostí ku všetkým posuvníkom
        const sliders = [productsSlider, allegroSlider, kauflandSlider, ordersSlider];
        sliders.forEach(slider => {
            slider.addEventListener('input', updatePricing);
        });

        // Inicializácia kalkulačky pri načítaní stránky
        updatePricing();
    </script>

</body>
</html>
